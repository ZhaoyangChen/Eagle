<?php

namespace App\Http\Controllers;

use App\Eagle_city;
use Illuminate\Foundation\Bus\DispatchesJobs;
use Illuminate\Routing\Controller as BaseController;
use Illuminate\Foundation\Validation\ValidatesRequests;
use Illuminate\Foundation\Auth\Access\AuthorizesRequests;

class CityListController extends BaseController
{
    use AuthorizesRequests, DispatchesJobs, ValidatesRequests;
    public function index() {
        $cities = self::citiesArray();
        $dateHeads = $this->dateHeadArray(7);
        $cityInfo = $this->structuredData($cities);
        return view('citylist', ['dateHeads' => $dateHeads, 'cityInfo' => $cityInfo, 'cities' => $cities]);
    }

    protected function dateHeadArray($num) {
        $res = [];
        for($i = 1; $i <= $num; $i++) {
            $res[] = date('Y-m-d', strtotime("-{$i} day"));
        }
        return $res;
    }

    protected function structuredData($cities) {
        $res = [];
        foreach ($cities as $cityEnglishName => $cityName) {
            if ($data = Eagle_city::where('city', $cityEnglishName)->get()) {
                foreach ($data as $d) {
                    $res[$cityEnglishName][$d->date] = $d;
                }
            }
        }
        return $res;
    }


    public static function citiesArray() {
        return [
            'www'   =>  'www站',
            'beijing' => '北京',
            'guangzhou' => '广州',
            'shanghai' => '上海',
            'tianjin' => '天津',
            'chongqing' => '重庆',
            'shenyang' => '沈阳',
            'nanjing' => '南京',
            'wuhan' => '武汉',
            'chengdu' => '成都',
            'xian' => '西安',
            'jixi' => '鸡西',
            'qitaihe' => '七台河',
            'hegang' => '鹤岗',
            'shuangyashan' => '双鸭山',
            'taian' => '泰安',
            'chuzhou' => '滁州',
            'laibin' => '来宾',
            'meishan' => '眉山',
            'longnan' => '陇南',
            'wuwei' => '武威',
            'jiayuguan' => '嘉峪关',
            'hezhou' => '贺州',
            'chongzuo' => '崇左',
            'yichun' => '伊春',
            'yili' => '伊犁',
            'ziyang' => '资阳',
            'zhongwei' => '中卫',
            'sanya' => '三亚',
            'xiantao' => '仙桃',
            'tianmen' => '天门',
            'qianjiang' => '潜江',
            'danzhou' => '儋州',
            'dongfang' => '东方',
            'wenchang' => '文昌',
            'qionghai' => '琼海',
            'wuzhishan' => '五指山',
            'wanning' => '万宁',
            'yl' => '玉林',
            'handan' => '邯郸',
            'shijiazhuang' => '石家庄',
            'baoding' => '保定',
            'zhangjiakou' => '张家口',
            'chengde' => '承德',
            'tangshan' => '唐山',
            'langfang' => '廊坊',
            'cangzhou' => '沧州',
            'hengshui' => '衡水',
            'xingtai' => '邢台',
            'qinhuangdao' => '秦皇岛',
            'shuozhou' => '朔州',
            'xinzhou' => '忻州',
            'taiyuan' => '太原',
            'datong' => '大同',
            'yangquan' => '阳泉',
            'jinzhong' => '晋中',
            'changzhi' => '长治',
            'jincheng' => '晋城',
            'linfen' => '临汾',
            'lvliang' => '吕梁',
            'yuncheng' => '运城',
            'shangqiu' => '商丘',
            'zhengzhou' => '郑州',
            'anyang' => '安阳',
            'xinxiang' => '新乡',
            'xuchang' => '许昌',
            'pingdingshan' => '平顶山',
            'xinyang' => '信阳',
            'nanyang' => '南阳',
            'kaifeng' => '开封',
            'luoyang' => '洛阳',
            'jiaozuo' => '焦作',
            'hebi' => '鹤壁',
            'puyang' => '濮阳',
            'zhoukou' => '周口',
            'luohe' => '漯河',
            'zhumadian' => '驻马店',
            'sanmenxia' => '三门峡',
            'jiyuan' => '济源',
            'tieling' => '铁岭',
            'dalian' => '大连',
            'anshan' => '鞍山',
            'fushun' => '抚顺',
            'benxi' => '本溪',
            'dandong' => '丹东',
            'jinzhou' => '锦州',
            'yingkou' => '营口',
            'fuxin' => '阜新',
            'liaoyang' => '辽阳',
            'chaoyang' => '朝阳',
            'panjin' => '盘锦',
            'huludao' => '葫芦岛',
            'changchun' => '长春',
            'jilin' => '吉林',
            'yanbian' => '延边',
            'siping' => '四平',
            'tonghua' => '通化',
            'baicheng' => '白城',
            'liaoyuan' => '辽源',
            'songyuan' => '松原',
            'baishan' => '白山',
            'haerbin' => '哈尔滨',
            'qiqihaer' => '齐齐哈尔',
            'mudanjiang' => '牡丹江',
            'jiamusi' => '佳木斯',
            'heihe' => '黑河',
            'suihua' => '绥化',
            'daqing' => '大庆',
            'hulunbeier' => '呼伦贝尔',
            'huhehaote' => '呼和浩特',
            'baotou' => '包头',
            'wuhai' => '乌海',
            'wulanchabu' => '乌兰察布',
            'tongliao' => '通辽',
            'chifeng' => '赤峰',
            'eerduosi' => '鄂尔多斯',
            'bayannaoer' => '巴彦淖尔',
            'xilinguole' => '锡林郭勒',
            'xingan' => '兴安',
            'alashan' => '阿拉善',
            'wuxi' => '无锡',
            'zhenjiang' => '镇江',
            'suzhou' => '苏州',
            'nantong' => '南通',
            'yangzhou' => '扬州',
            'yancheng' => '盐城',
            'xuzhou' => '徐州',
            'huaian' => '淮安',
            'lianyungang' => '连云港',
            'changzhou' => '常州',
            'tz' => '泰州',
            'suqian' => '宿迁',
            'heze' => '菏泽',
            'jinan' => '济南',
            'qingdao' => '青岛',
            'zibo' => '淄博',
            'dezhou' => '德州',
            'yantai' => '烟台',
            'weifang' => '潍坊',
            'jining' => '济宁',
            'weihai' => '威海',
            'linyi' => '临沂',
            'binzhou' => '滨州',
            'dongying' => '东营',
            'fuyang' => '阜阳',
            'hefei' => '合肥',
            'bengbu' => '蚌埠',
            'wuhu' => '芜湖',
            'huainan' => '淮南',
            'maanshan' => '马鞍山',
            'anqing' => '安庆',
            'sz' => '宿州',
            'bozhou' => '亳州',
            'huangshan' => '黄山',
            'huaibei' => '淮北',
            'tongling' => '铜陵',
            'xuancheng' => '宣城',
            'luan' => '六安',
            'chaohu' => '巢湖',
            'chizhou' => '池州',
            'quzhou' => '衢州',
            'hangzhou' => '杭州',
            'huzhou' => '湖州',
            'jiaxing' => '嘉兴',
            'ningbo' => '宁波',
            'shaoxing' => '绍兴',
            'taizhou' => '台州',
            'wenzhou' => '温州',
            'lishui' => '丽水',
            'jinhua' => '金华',
            'zhoushan' => '舟山',
            'fuzhou' => '福州',
            'xiamen' => '厦门',
            'ningde' => '宁德',
            'putian' => '莆田',
            'quanzhou' => '泉州',
            'zhangzhou' => '漳州',
            'longyan' => '龙岩',
            'sanming' => '三明',
            'nanping' => '南平',
            'zaozhuang' => '枣庄',
            'rizhao' => '日照',
            'laiwu' => '莱芜',
            'liaocheng' => '聊城',
            'shanwei' => '汕尾',
            'yangjiang' => '阳江',
            'jieyang' => '揭阳',
            'maoming' => '茂名',
            'xishuangbanna' => '西双版纳',
            'dehong' => '德宏',
            'yingtan' => '鹰潭',
            'xiangfan' => '襄阳',
            'ezhou' => '鄂州',
            'xiaogan' => '孝感',
            'huanggang' => '黄冈',
            'huangshi' => '黄石',
            'xianning' => '咸宁',
            'jingzhou' => '荆州',
            'yichang' => '宜昌',
            'shiyan' => '十堰',
            'suizhou' => '随州',
            'jingmen' => '荆门',
            'enshi' => '恩施',
            'shennongjia' => '神农架',
            'yueyang' => '岳阳',
            'changsha' => '长沙',
            'xiangtan' => '湘潭',
            'zhuzhou' => '株洲',
            'hengyang' => '衡阳',
            'chenzhou' => '郴州',
            'changde' => '常德',
            'yiyang' => '益阳',
            'loudi' => '娄底',
            'shaoyang' => '邵阳',
            'xiangxi' => '湘西',
            'zhangjiajie' => '张家界',
            'huaihua' => '怀化',
            'yongzhou' => '永州',
            'jiangmen' => '江门',
            'shaoguan' => '韶关',
            'huizhou' => '惠州',
            'meizhou' => '梅州',
            'shantou' => '汕头',
            'shenzhen' => '深圳',
            'zhuhai' => '珠海',
            'foshan' => '佛山',
            'zhaoqing' => '肇庆',
            'zhanjiang' => '湛江',
            'zhongshan' => '中山',
            'heyuan' => '河源',
            'qingyuan' => '清远',
            'yunfu' => '云浮',
            'chaozhou' => '潮州',
            'dongguan' => '东莞',
            'fangchenggang' => '防城港',
            'nanning' => '南宁',
            'liuzhou' => '柳州',
            'guilin' => '桂林',
            'wuzhou' => '梧州',
            'guigang' => '贵港',
            'bose' => '百色',
            'qinzhou' => '钦州',
            'hechi' => '河池',
            'beihai' => '北海',
            'xinyu' => '新余',
            'nanchang' => '南昌',
            'jiujiang' => '九江',
            'shangrao' => '上饶',
            'fz' => '抚州',
            'yc' => '宜春',
            'jian' => '吉安',
            'ganzhou' => '赣州',
            'jingdezhen' => '景德镇',
            'pingxiang' => '萍乡',
            'panzhihua' => '攀枝花',
            'zigong' => '自贡',
            'mianyang' => '绵阳',
            'nanchong' => '南充',
            'dazhou' => '达州',
            'suining' => '遂宁',
            'guangan' => '广安',
            'bazhong' => '巴中',
            'luzhou' => '泸州',
            'yibin' => '宜宾',
            'neijiang' => '内江',
            'leshan' => '乐山',
            'liangshan' => '凉山',
            'yaan' => '雅安',
            'ganzi' => '甘孜',
            'aba' => '阿坝',
            'deyang' => '德阳',
            'guangyuan' => '广元',
            'guiyang' => '贵阳',
            'zunyi' => '遵义',
            'anshun' => '安顺',
            'qiannan' => '黔南',
            'qiandongnan' => '黔东南',
            'tongren' => '铜仁',
            'bijie' => '毕节',
            'liupanshui' => '六盘水',
            'qianxinan' => '黔西南',
            'zhaotong' => '昭通',
            'kunming' => '昆明',
            'dali' => '大理',
            'honghe' => '红河',
            'qujing' => '曲靖',
            'baoshan' => '保山',
            'wenshan' => '文山',
            'yuxi' => '玉溪',
            'chuxiong' => '楚雄',
            'puer' => '普洱',
            'lincang' => '临沧',
            'nujiang' => '怒江',
            'diqing' => '迪庆',
            'lijiang' => '丽江',
            'lasa' => '拉萨',
            'rikaze' => '日喀则',
            'shannan' => '山南',
            'linzhi' => '林芝',
            'changdu' => '昌都',
            'naqu' => '那曲',
            'ali' => '阿里',
            'haikou' => '海口',
            'tacheng' => '塔城',
            'hami' => '哈密',
            'hetian' => '和田',
            'aletai' => '阿勒泰',
            'boertala' => '博尔塔拉',
            'xianyang' => '咸阳',
            'yanan' => '延安',
            'yulin' => '榆林',
            'weinan' => '渭南',
            'shangluo' => '商洛',
            'ankang' => '安康',
            'hanzhong' => '汉中',
            'baoji' => '宝鸡',
            'tongchuan' => '铜川',
            'linxia' => '临夏',
            'lanzhou' => '兰州',
            'dingxi' => '定西',
            'pingliang' => '平凉',
            'qingyang' => '庆阳',
            'jinchang' => '金昌',
            'zhangye' => '张掖',
            'jiuquan' => '酒泉',
            'tianshui' => '天水',
            'gannan' => '甘南',
            'baiyin' => '白银',
            'yinchuan' => '银川',
            'shizuishan' => '石嘴山',
            'wuzhong' => '吴忠',
            'guyuan' => '固原',
            'haibei' => '海北',
            'xining' => '西宁',
            'haidong' => '海东',
            'huangnan' => '黄南',
            'guoluo' => '果洛',
            'yushu' => '玉树',
            'haixi' => '海西',
            'hainan' => '海南',
            'kelamayi' => '克拉玛依',
            'wulumuqi' => '乌鲁木齐',
            'shihezi' => '石河子',
            'changji' => '昌吉',
            'tulufan' => '吐鲁番',
            'bayinguoleng' => '巴音郭楞',
            'akesu' => '阿克苏',
            'kashi' => '喀什',
            'kunshan' => '昆山',
            'changshu' => '常熟',
            'zhangjiagang' => '张家港',
            'taicang' => '太仓',
            'daxinganling' => '大兴安岭',
            'kezilesu' => '克孜勒苏',
            'alaer' => '阿拉尔',
            'wujiaqu' => '五家渠',
            'tumushuke' => '图木舒克',
            'baisha' => '白沙',
            'sansha' => '三沙',
            'baoting' => '保亭',
            'changjiang' => '昌江',
            'chengmai' => '澄迈',
            'dingan' => '定安',
            'ledong' => '乐东',
            'lingao' => '临高',
            'lingshui' => '陵水',
            'qiongzhong' => '琼中',
            'tunchang' => '屯昌',
        ];
    }
}
